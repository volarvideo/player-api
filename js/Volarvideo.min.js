/*! VOLAR VIDEO PLAYER API - 2014-11-11 */
(function(){var __slice=[].slice;this.Volarvideo=function(){function a(a){null==a&&(a=null),a&&this.connect(a)}return a.prototype.events={},a.prototype.debug=!1,a.prototype.iframe=null,a.prototype.channel=null,a.prototype.connected=!1,a.prototype.retry=5,a.prototype.retryInterval=500,a.prototype.logging=!1,a.prototype._mcSupport=!1,a.prototype._dataSeperator="/|\\",a.prototype._queue=[],a.prototype.on=function(a,b,c){return null==c&&(c=-1),"connect"===a&&this.connected&&b(),this.events[a]||(this.events[a]=[]),this.events[a].push({"function":b,life:c})},a.prototype.one=function(a,b){return this.on(a,b,1)},a.prototype.trigger=function(a,b){var c,d,e,f,g,h,i,j;if(this.events[a]){for(e=[],j=this.events[a],c=f=0,h=j.length;h>f;c=++f)d=j[c],d["function"].apply(void 0,[b]),this.events[a][c].life>0&&this.events[a][c].life--,0===this.events[a][c].life&&e.push(d["function"]);for(g=0,i=e.length;i>g;g++)d=e[g],this.off(a,d)}},a.prototype.off=function(a,b){var c,d,e,f,g;if(null==b&&(b=null),b&&this.events[a]){for(d=[],g=this.events[a],e=0,f=g.length;f>e;e++)c=g[e],c["function"]!==b&&d.push(c);delete this.events[a],this.events[a]=d}else delete this.events[a]},a.prototype.play=function(){return this.send("play")},a.prototype.pause=function(){return this.send("pause")},a.prototype.seek=function(a){return this.send("seek",[a])},a.prototype.duration=function(a){return this.one("duration",a),this.send("duration")},a.prototype.bitrate=function(a){return this.one("bitrate",a),this.send("bitrate")},a.prototype.videoHeight=function(a){return this.one("videoHeight",a),this.send("videoHeight")},a.prototype.availableHeights=function(a){return this.one("availableHeights",a),this.send("availableHeights")},a.prototype.statsForNerds=function(a){return this.one("statsForNerds",a),this.send("statsForNerds")},a.prototype.playerVersion=function(a){return this.one("playerVersion",a),this.send("playerVersion")},a.prototype.enableLogging=function(){return this.logging=!0,this.send("enableLogging")},a.prototype.disableLogging=function(){return this.logging=!1,this.send("disableLogging")},a.prototype.connect=function(a){var b,c,d;d=0,c=this,b=setInterval(function(){return c.connected&&(c.log("connected"),clearInterval(b)),d>=c.retry&&(c.warn("max # of connection retries reached"),clearInterval(b)),c.doconnect(a),d++},this.retryInterval)},a.prototype.doconnect=function(a){var b,c;if(this.iframe=a,c=this,window.MessageChannel){this._mcSupport=!0;try{this.channel=new MessageChannel,this.channel.port1.onmessage=function(a){var b,d,e,f,g;if(b=c.munchData(a.data),c.log("data recieved: ",b),b.type){switch(b.type){case"test":b.args?c.log("test returned",b.args):c.log("test returned");break;case"connected":if(!c.connected&&(c.connected=!0,c.log("Connection to volarvideo object made"),c._queue.length>0))for(g=c._queue,e=0,f=g.length;f>e;e++)d=g[e],c.send.apply(c,d)}c.trigger(b.type,b)}},this.log("sending initial message"),this.iframe.contentWindow.postMessage(JSON.stringify({type:"connect"}),this.iframe.src,[this.channel.port2])}catch(d){return b=d,this.trigger("error",b),this.error(b),!1}return!0}if(window.postMessage){try{this.iframe.contentWindow.postMessage(JSON.stringify({type:"connect"}),this.iframe.src),window.addEventListener("message",function(a){var b,d,e,f,g;if(b=c.munchData(a.data),c.log("data recieved: ",b),b.type){switch(b.type){case"test":b.args?c.log("test returned",b.args):c.log("test returned");break;case"connected":if(c.connected=!0,c.log("Connection to volarvideo object made"),c._queue.length>0)for(g=c._queue,e=0,f=g.length;f>e;e++)d=g[e],c.send.apply(c,d)}c.trigger(b.type,b)}},!1)}catch(d){return b=d,this.trigger("error",b),this.error(b),!1}return!0}return this.trigger("error",new Error("cannot connect to iframe channel - window.MessageChannel not supported")),this.error("cannot connect to iframe channel - window.MessageChannel not supported"),!1},a.prototype.disconnect=function(){return this.iframe=null,this.channel=null,this.connected=!1,!0},a.prototype.send=function(a,b){var c;if(null==b&&(b=null),this.connected){try{this.iframe.contentWindow.postMessage(this.prepareData(a,b),this.iframe.src)}catch(d){return c=d,this.error(c),!1}return!0}return this._queue.push([a,b]),!1},a.prototype.prepareData=function(a,b){var c;return null==b&&(b=null),c={type:a,args:[]},null!==b&&(c.args=b),JSON.stringify(c)},a.prototype.munchData=function(a){return JSON.parse(a)},a.prototype.log=function(){var a;return a=1<=arguments.length?__slice.call(arguments,0):[],this.logging&&window.console&&console.log?(a.unshift("{local}"),console.log.apply(console,a)):void 0},a.prototype.warn=function(){var a;return a=1<=arguments.length?__slice.call(arguments,0):[],this.logging&&window.console&&console.warn?(a.unshift("{local}"),console.warn.apply(console,a)):void 0},a.prototype.error=function(){var a;return a=1<=arguments.length?__slice.call(arguments,0):[],this.logging&&window.console&&console.error?(a.unshift("{local}"),console.error.apply(console,a)):void 0},a}(),"object"!=typeof this.JSON&&(this.JSON={}),function(){function l(a){return 10>a?"0"+a:a}function q(a){return r.lastIndex=0,r.test(a)?'"'+a.replace(r,function(a){var b=t[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function n(a,b){var c,d,f,g,h,i=e,k=b[a];switch(k&&"object"==typeof k&&"function"==typeof k.toJSON&&(k=k.toJSON(a)),"function"==typeof j&&(k=j.call(b,a,k)),typeof k){case"string":return q(k);case"number":return isFinite(k)?String(k):"null";case"boolean":case"null":return String(k);case"object":if(!k)return"null";if(e+=m,h=[],"[object Array]"===Object.prototype.toString.apply(k)){for(g=k.length,c=0;g>c;c+=1)h[c]=n(c,k)||"null";return f=0===h.length?"[]":e?"[\n"+e+h.join(",\n"+e)+"\n"+i+"]":"["+h.join(",")+"]",e=i,f}if(j&&"object"==typeof j)for(g=j.length,c=0;g>c;c+=1)"string"==typeof j[c]&&(d=j[c],(f=n(d,k))&&h.push(q(d)+(e?": ":":")+f));else for(d in k)Object.prototype.hasOwnProperty.call(k,d)&&(f=n(d,k))&&h.push(q(d)+(e?": ":":")+f);return f=0===h.length?"{}":e?"{\n"+e+h.join(",\n"+e)+"\n"+i+"}":"{"+h.join(",")+"}",e=i,f}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var s=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,m,t={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(m=e="","number"==typeof c)for(d=0;c>d;d+=1)m+=" ";else"string"==typeof c&&(m=c);if((j=b)&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw Error("JSON.stringify");return n("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(a,e){function c(a,b){var d,f,g=a[b];if(g&&"object"==typeof g)for(d in g)Object.prototype.hasOwnProperty.call(g,d)&&(f=c(g,d),void 0!==f?g[d]=f:delete g[d]);return e.call(a,b,g)}var d;if(a=String(a),s.lastIndex=0,s.test(a)&&(a=a.replace(s,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),"function"==typeof e?c({"":d},""):d;throw new SyntaxError("JSON.parse")})}()}).call(this);